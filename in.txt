COPY START 0
CCV COMP =C'EOF'
FIRST STL RETADR
L LDB #LENGTH
BLA EQU *
L BASE LENGTH
CLOOP +JSUB RDREC
L LDA LENGTH
L COMP #0
L JEQ ENDFIL
L +JSUB WRREC
L LTRORG L
BLA J CLOOP
ENDFIL LDA EOF
L STA BUFFER
L LDA #3
L STA LENGTH
L +JSUB WRREC
L J @RETADR
EOF BYTE C'EOF'
RETADR RESW 1
LENGTH RESW 1
BUFFER RESB 4096
RDREC CLEAR X
L CLEAR A
L CLEAR S
L +LDT #4096
RLOOP TD INPUT
L JEQ RLOOP
L RD INPUT
L COMPR A,S
L JEQ EXIT
F $COMP X
B STCH BUFFER,X
L TIXR T
L JLT RLOOP
EXIT STX LENGTH
L RSUB L
INPUT BYTE X'F1'
WRREC CLEAR X
L LDT LENGTH
WLOOP TD OUTPUT
X JEQ WLOOP
B LDCH BUFFER,X
V WD OUTPUT
K TIXR T
L JLT WLOOP
L RSUB 1
L RESDW 1
OUTPUT BYTE X'05'
L END FIRST
* =X'05' `